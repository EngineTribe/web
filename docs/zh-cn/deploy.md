# ğŸ—„ï¸ éƒ¨ç½²å¼•æ“éƒ¨è½

å¼•æ“éƒ¨è½çš„ API å’Œ bot æ˜¯åˆ†å¼€çš„ï¼Œå¯ä»¥å•ç‹¬éƒ¨ç½²ã€‚

## ğŸ“‘ åˆ›å»ºé…ç½®æ–‡ä»¶

é¦–å…ˆï¼Œæ‚¨éœ€è¦åœ¨å¼•æ“éƒ¨è½çš„æ ¹ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªåä¸º `config.yml` çš„é…ç½®æ–‡ä»¶ã€‚  
æ‚¨å¯ä»¥å¤åˆ¶é»˜è®¤é…ç½®æ–‡ä»¶ `config.default.yml` å¹¶å°†å…¶é‡å‘½åä¸º `config.yml` ã€‚

æ‚¨ä¹Ÿå¯ä»¥è®¾ç½® `CONFIG_PATH` ç¯å¢ƒå˜é‡æ¥æŒ‡å®šå¤–éƒ¨é…ç½®æ–‡ä»¶ã€‚

## ğŸŒ API

API é…ç½®ä½äºé…ç½®æ–‡ä»¶çš„â€œenginetribeâ€éƒ¨åˆ†ã€‚

- `host`ï¼šå¼•æ“éƒ¨è½ç›‘å¬çš„ä¸»æœºåã€‚
- `port`: å¼•æ“éƒ¨è½ç›‘å¬çš„ç«¯å£ï¼Œé»˜è®¤ä¸º `30000` ã€‚
- `workers`: å¼•æ“éƒ¨è½æœåŠ¡å™¨ä½¿ç”¨çš„çº¿ç¨‹æ•°ï¼Œé»˜è®¤ä¸º`1`ï¼Œå»ºè®®è®¾ç½®ä¸º CPU æ ¸å¿ƒæ•°ä»¥è·å¾—æœ€ä½³æ€§èƒ½ã€‚
- `api_root`ï¼šç”Ÿæˆçš„å…³å¡ä¸‹è½½é“¾æ¥çš„å‰ç¼€ï¼ŒåŒ…æ‹¬æœ«å°¾æ–œæ ã€‚
  å¦‚æœæ‚¨ä½¿ç”¨ Nginx ç­‰åå‘ä»£ç†ï¼Œåˆ™å¯ä»¥å°†å…¶è®¾ç½®ä¸ºåå‘ä»£ç†çš„ urlã€‚
- `api_key`ï¼šç”¨æˆ·å’Œå®¢æˆ·ç«¯ API æ‰€éœ€çš„ API å¯†é’¥ï¼Œå¼•æ“æœºå™¨äººä½¿ç”¨å®ƒæ¥è¿æ¥åˆ° APIã€‚  
  æ‚¨å¯ä»¥ç”Ÿæˆä¸€ä¸ªéšæœºå­—ç¬¦ä¸²ä½œä¸º API å¯†é’¥ã€‚
- `verify_user_agent`: æ˜¯å¦éªŒè¯å®¢æˆ·ç«¯çš„ User-Agentã€‚  
  å¦‚æœè®¾ç½®ä¸º `true` ï¼Œå®¢æˆ·ç«¯å¿…é¡»æ˜¯æœ‰æ•ˆçš„ SMM:WE æ¸¸æˆï¼Œå¦åˆ™è¯·æ±‚å°†è¢«æ‹’ç»ã€‚  
  æ‚¨å¯ä»¥[åœ¨æ­¤](https://github.com/EngineTribe/EngineTribe/blob/main/depends.py#L10) æŸ¥çœ‹æœ‰æ•ˆ User-Agent åˆ—è¡¨ã€‚
- `cors_allowed_domain`ï¼šAPI çš„ `Access-Control-Allow-Origin` å“åº”å¤´ï¼Œå¯ä»¥æ˜¯ `*` æˆ–åŸŸåã€‚
- `rows_perpage`ï¼šå…¨çƒå…³å¡ä¸­æ¯é¡µçš„çº§åˆ«æ•°ã€‚
- `upload_limit`ï¼šç”¨æˆ·å¯ä»¥ä¸Šä¼ çš„æœ€å¤§å…³å¡æ•°ã€‚
- `booster_extra_limit`ï¼šæèµ  Discord æœåŠ¡å™¨çš„ç”¨æˆ·å¯ä»¥ä¸Šä¼ çš„é¢å¤–å…³å¡æ•°ã€‚
- `record_clear_users`: æ˜¯å¦è®°å½•é€šå…³ç”¨æˆ·ã€‚  
  ç¦ç”¨æ­¤é€‰é¡¹ä¹Ÿå°†ç¦ç”¨è¯¦ç»†æœç´¢çš„â€œå†å²â€å­—æ®µã€‚

## ğŸ—„ï¸ æ•°æ®åº“

### ğŸ’¼ ä¸»æ•°æ®åº“

å¼•æ“éƒ¨è½éœ€è¦ SQL æ•°æ®åº“æ‰èƒ½å·¥ä½œï¼Œæ”¯æŒ MySQLã€PostgreSQL å’Œ SQLiteã€‚

SQL æ•°æ®åº“é…ç½®ä½äºé…ç½®æ–‡ä»¶çš„â€œæ•°æ®åº“â€éƒ¨åˆ†ã€‚

- `adapter`: æ•°æ®åº“çš„ç±»å‹ï¼Œå¯ä»¥æ˜¯ `mysql` , `postgresql` æˆ– `sqlite` ã€‚
- `host`ï¼šæ•°æ®åº“çš„ä¸»æœºåæˆ– SQLite æ•°æ®åº“çš„æ–‡ä»¶è·¯å¾„ã€‚
- `port`ï¼šæ•°æ®åº“çš„ç«¯å£ï¼ŒMySQL é»˜è®¤ä¸º`3306`ï¼ŒPostgreSQL é»˜è®¤ä¸º`5432`ï¼ŒSQLite ä¸éœ€è¦ã€‚
- `user`ï¼šæ•°æ®åº“çš„ç”¨æˆ·åã€‚
- `password`: æ•°æ®åº“çš„å¯†ç ã€‚
- `ssl`: æ˜¯å¦ä½¿ç”¨ SSL è¿æ¥æ•°æ®åº“ã€‚
- `debug`: æ˜¯å¦æ‰“å°æ‰§è¡Œçš„ SQL è¯­å¥ï¼ˆä»…ç”¨äºè°ƒè¯•ï¼‰ã€‚

### â° ä¼šè¯

> `auth_code` æ˜¯å”¯ä¸€çš„ä¼šè¯ä»£ç ï¼Œç”¨äºåˆ¤æ–­ä¼šè¯çš„çœŸå®æ€§  
> è¯·è®°ä½ï¼Œauth_code æ˜¯æˆ‘åœ¨ SMMWE Online ä¸­ä½œä¸ºä¿å­˜ä¼šè¯çš„æ–¹æ³•åˆ›å»ºçš„æœºåˆ¶     
> æ¯ä¸ªè´¦å·åªèƒ½æœ‰ä¸€ä¸ªæ¿€æ´»çš„ `auth_code`ï¼Œä¹Ÿå°±æ˜¯è¯´åŒä¸€ä¸ª SMMWE è´¦å·ä¸èƒ½åŒæ—¶åœ¨ä¸¤å°è®¾å¤‡ä¸Šç©  
> â€”â€” DangerousZone

å¼•æ“éƒ¨è½è¿˜éœ€è¦ä¸€ä¸ª Redis æ•°æ®åº“æ¥å­˜å‚¨ç™»å½•ä¼šè¯ï¼ŒRedis æ•°æ®åº“é…ç½®åœ¨é…ç½®æ–‡ä»¶çš„ `redis` éƒ¨åˆ†ã€‚

- `host`ï¼šRedis æ•°æ®åº“çš„ä¸»æœºåã€‚
- `port`ï¼šRedis æ•°æ®åº“çš„ç«¯å£ï¼Œé»˜è®¤ä¸º `6379` ã€‚
- `database`: Redis æ•°æ®åº“çš„æ•°æ®åº“ç¼–å·ã€‚
- `passowrd`ï¼šRedis æ•°æ®åº“çš„å¯†ç ã€‚

## ğŸ“¦ å­˜å‚¨åç«¯

å¼•æ“éƒ¨è½æ”¯æŒå¤šä¸ªå­˜å‚¨åç«¯ï¼Œç›®å‰æ”¯æŒæœ¬åœ°å­˜å‚¨ã€OneDrive å’Œ Discordã€‚

å­˜å‚¨åç«¯é…ç½®ä½äºé…ç½®æ–‡ä»¶çš„â€œstorageâ€éƒ¨åˆ†ã€‚

- `provider`ï¼šå­˜å‚¨åç«¯çš„ç±»å‹ï¼Œå¯ä»¥æ˜¯ `database` ï¼Œ `onemanager` ï¼Œ `onedrive-cf` æˆ– `discord` ã€‚
    - `database`: åœ¨ä¸»æ•°æ®åº“ä¸­å­˜å‚¨å…³å¡ï¼Œè¿™æ˜¯é»˜è®¤å’Œæ¨èçš„é€‰é¡¹ã€‚
    - `onemanager`ï¼šé€šè¿‡ [OneManager](https://github.com/qkqpttgf/OneManager-php) åœ¨ OneDrive ä¸­å­˜å‚¨å…³å¡ã€‚
    - `onedrive-cf`ï¼šé€šè¿‡ [OneDrive CF Index](https://github.com/spencerwooo/onedrive-cf-index) åœ¨ OneDrive ä¸­å­˜å‚¨å…³å¡ã€‚
    - `discord`ï¼šé€šè¿‡ Discord å¼•æ“æœºå™¨äººåœ¨ Discord ä¸­å­˜å‚¨å…³å¡ã€‚
- `url`ï¼š
    - å¯¹äº `onemanager` ï¼ŒOneManager å®ä¾‹çš„ urlï¼Œå°¾éƒ¨å¸¦æœ‰ç½‘ç›˜åç§°å’Œæ–œæ ã€‚
    - å¯¹äº `onedrive-cf` ï¼ŒOneDrive CF Index å®ä¾‹çš„ urlï¼Œå¸¦æœ‰å°¾éƒ¨æ–œæ ã€‚
    - å¯¹äº `discord`ï¼Œä¸º Discord çš„å¼•æ“æœºå™¨äººé…ç½®çš„ webhook urlã€‚
    - å¯¹äº `database`ï¼Œè¯¥å­—æ®µä¸æ˜¯å¿…éœ€çš„ã€‚
- `auth_key`ï¼šOneManager æˆ– OneDrive CF Index çš„æˆæƒå¯†é’¥ï¼ŒDiscord å’Œæœ¬åœ°æ•°æ®åº“ä¸éœ€è¦ã€‚
- `proxied`ï¼šæ˜¯å¦é€šè¿‡ CloudFlare CDN ä»£ç†å…³å¡ï¼ˆä»… OneDrive CF Indexï¼‰ã€‚
- `attachment_channel_id`ï¼šè¦ä¸Šä¼ å…³å¡çš„ Discord é¢‘é“ IDï¼Œä»… Discordã€‚

## ğŸ’¬ æ¶ˆæ¯æ¨é€

å¼•æ“éƒ¨è½å¯ä»¥æŠŠæ–°å…³å¡æ¶ˆæ¯ã€å…³å¡ç»Ÿè®¡æ¶ˆæ¯å’Œè§’è‰²åˆ†é…æ¶ˆæ¯æ¨é€åˆ° Discord Webhooks æˆ–å¼•æ“æœºå™¨äººã€‚

æ¶ˆæ¯æ¨é€é…ç½®åœ¨é…ç½®æ–‡ä»¶çš„`push`éƒ¨åˆ†ã€‚

### ğŸ“¨ Discord Webhook

Discord Webhook é…ç½®ä½äº `discord` éƒ¨åˆ†ã€‚

- `enabled`ï¼šæ˜¯å¦å¯ç”¨ Discord Webhook æ¨é€ã€‚
- `enable_new_arrival`: æ˜¯å¦æ¨é€æ–°å…³å¡æ¶ˆæ¯ã€‚
- `urls`ï¼šè¦å°†æ¶ˆæ¯æ¨é€åˆ°çš„ Discord é¢‘é“çš„ webhook urlã€‚
- `avatar`ï¼šwebhook çš„å¤´åƒ urlã€‚
- 
### ğŸ¤– å¼•æ“æœºå™¨äºº

å¯¹äº QQã€Telegram ç­‰ä¸æ”¯æŒ Webhook çš„èŠå¤©è½¯ä»¶ï¼Œå¼•æ“æœºå™¨äººå¯ä»¥é€šè¿‡ç»Ÿä¸€æ¨é€æ¥æ¨é€æ¶ˆæ¯ã€‚

- `enabled`ï¼šæ˜¯å¦å¯ç”¨å¼•æ“æœºå™¨äººæ¨é€ã€‚
- `enable_new_arrival`: æ˜¯å¦æ¨é€æ–°å…³å¡æ¶ˆæ¯ã€‚
- `enable_counter`: æ˜¯å¦æ¨é€å…³å¡ç»Ÿè®¡æ¶ˆæ¯ï¼ˆå¦‚è·å¾— 100 èµï¼‰ã€‚
- `urls`ï¼šè¦å°†æ¶ˆæ¯æ¨é€åˆ°çš„å¼•æ“æœºå™¨äººçš„ webhook urlã€‚
